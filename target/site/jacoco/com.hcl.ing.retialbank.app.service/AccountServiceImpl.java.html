<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AccountServiceImpl.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">RetailBankingApp</a> &gt; <a href="index.source.html" class="el_package">com.hcl.ing.retialbank.app.service</a> &gt; <span class="el_source">AccountServiceImpl.java</span></div><h1>AccountServiceImpl.java</h1><pre class="source lang-java linenums">package com.hcl.ing.retialbank.app.service;

import java.util.ArrayList;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.hcl.ing.retialbank.app.dto.AccountSummaryDto;
import com.hcl.ing.retialbank.app.dto.AccountSummaryResponse;
import com.hcl.ing.retialbank.app.dto.AccountUpdateRequest;
import com.hcl.ing.retialbank.app.dto.AccountUpdateResponse;
import com.hcl.ing.retialbank.app.dto.SearchRequest;
import com.hcl.ing.retialbank.app.dto.TransactionDto;
import com.hcl.ing.retialbank.app.entity.AccountSummary;
import com.hcl.ing.retialbank.app.entity.Transaction;
import com.hcl.ing.retialbank.app.repository.AccountSummaryRepository;
import com.hcl.ing.retialbank.app.repository.CustomerRepository;
import com.hcl.ing.retialbank.app.repository.TransactionRepository;

@Service
<span class="fc" id="L22">public class AccountServiceImpl implements AccountService {</span>
	
	@Autowired
	private AccountSummaryRepository accountSummaryRepository; 
	
	@Autowired
	private CustomerRepository customerRepository;
	
	@Autowired
	private TransactionRepository transactionRepository;
	

	@Override
	public AccountSummaryResponse searchByAccountNoOrAccountName(SearchRequest request) {
<span class="fc" id="L36">		AccountSummaryResponse response=new AccountSummaryResponse();</span>
		try {
			
<span class="fc" id="L39">			List&lt;AccountSummary&gt; listOfAcc = accountSummaryRepository.findByAccountNoOrAccountName(request.getAccountNo(), request.getAccountName());</span>
<span class="fc" id="L40">			List&lt;AccountSummaryDto&gt; dtoList=new ArrayList&lt;&gt;();</span>
<span class="pc bpc" id="L41" title="1 of 2 branches missed.">			if(!listOfAcc.isEmpty()) {</span>
<span class="fc" id="L42">				listOfAcc.stream().forEach(account -&gt;{</span>
<span class="fc" id="L43">					AccountSummaryDto dto=new AccountSummaryDto();</span>
<span class="fc" id="L44">					dto.setAccountNo(account.getAccountNo());</span>
<span class="fc" id="L45">					dto.setAccountName(account.getAccountName());</span>
<span class="fc" id="L46">					dto.setAccountType(account.getAccountType());</span>
<span class="fc" id="L47">					dto.setAddress(account.getAddress());</span>
<span class="fc" id="L48">					dto.setBranchName(account.getBranchName());</span>
<span class="fc" id="L49">					dto.setClosingBalance(account.getClosingBalance());</span>
<span class="fc" id="L50">					dto.setDob(account.getDob());</span>
<span class="fc" id="L51">					dto.setCreateDt(account.getCreateDt());</span>
<span class="fc" id="L52">					dtoList.add(dto);</span>
<span class="fc" id="L53">					response.setSummaryList(dtoList);</span>
<span class="fc" id="L54">				});</span>
			}
			
			
<span class="nc" id="L58">		} catch (Exception e) {</span>
<span class="fc" id="L59">		}</span>
<span class="fc" id="L60">		return response;</span>
	}

	@Override
	public AccountUpdateResponse updateAccountDetails(AccountUpdateRequest request) {
<span class="fc" id="L65">		AccountUpdateResponse response=new AccountUpdateResponse();</span>
		try {
			
<span class="pc bpc" id="L68" title="1 of 2 branches missed.">			if(request!=null) {</span>
<span class="fc" id="L69">				AccountSummary summary = getAccountSummary(request.getAccountNo());</span>
<span class="pc bpc" id="L70" title="1 of 2 branches missed.">				if(summary!=null) {</span>
<span class="fc" id="L71">					summary.setAccountName(request.getAccountName());</span>
<span class="fc" id="L72">					summary.setAccountNo(request.getAccountNo());</span>
<span class="fc" id="L73">					summary.setAccountType(request.getAccountType());</span>
<span class="fc" id="L74">					summary.setAddress(request.getAddress());</span>
<span class="fc" id="L75">					summary.setBranchName(request.getBranchName());</span>
<span class="fc" id="L76">					summary.setDob(request.getDob());</span>
<span class="fc" id="L77">					accountSummaryRepository.save(summary);</span>
<span class="fc" id="L78">					response.setMessage(&quot;Account details updated successfully...!&quot;);</span>
				}else {
<span class="nc" id="L80">					response.setMessage(&quot;Account is not available , please create an account&quot;);</span>
				}
			}
			
			
<span class="nc" id="L85">		} catch (Exception e) {</span>
			
<span class="fc" id="L87">		}</span>
<span class="fc" id="L88">		return response;</span>
	}

	
	private AccountSummary getAccountSummary(Long accoutNo) {
<span class="fc" id="L93">		AccountSummary summary=null;</span>
		try {
<span class="fc" id="L95">			summary=accountSummaryRepository.findByAccountNo(accoutNo);</span>
<span class="nc" id="L96">		} catch (Exception e) {</span>
			
<span class="fc" id="L98">		}</span>
<span class="fc" id="L99">		return summary;</span>
	}
	
	@Override
	public List&lt;TransactionDto&gt; getRecentTransaction(Long accountNo) {
<span class="nc" id="L104">		 List&lt;TransactionDto&gt; response=new ArrayList&lt;&gt;();</span>
		try {
<span class="nc" id="L106">			List&lt;Transaction&gt; list = transactionRepository.findByFromAccountNumberOrderByTransactionDateDesc(accountNo);</span>
<span class="nc bnc" id="L107" title="All 2 branches missed.">			if(!list.isEmpty()) {</span>
<span class="nc" id="L108">				list.stream().forEach(transaction -&gt;{</span>
<span class="nc" id="L109">					TransactionDto dto=new TransactionDto();</span>
<span class="nc" id="L110">					dto.setAccountNumber(transaction.getAccountNumber());</span>
<span class="nc" id="L111">					dto.setClosingBalance(transaction.getClosingBalance());</span>
<span class="nc" id="L112">					dto.setFromAccountNumber(transaction.getFromAccountNumber());</span>
<span class="nc" id="L113">					dto.setTransactionAmount(transaction.getTransactionAmount());</span>
<span class="nc" id="L114">					dto.setTransactionDate(transaction.getTransactionDate());</span>
<span class="nc" id="L115">					dto.setTransactionId(transaction.getTransactionId());</span>
<span class="nc" id="L116">					dto.setTransactionRemarks(transaction.getTransactionRemarks());</span>
<span class="nc" id="L117">					dto.setTransactionType(transaction.getTransactionType());</span>
<span class="nc" id="L118">					response.add(dto);</span>
<span class="nc" id="L119">				});</span>
			}
			
<span class="nc" id="L122">		} catch (Exception e) {</span>
			
<span class="nc" id="L124">		}</span>
<span class="nc" id="L125">		return response;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>